# 函式庫使用方法

* * * *

在函式庫中包含`EthernetLightingController`與`Rs232LightingController`類別，分別提供Ethernet與RS232通訊介面的控制器控制方法。

`EthernetLightingController`與`Rs232LightingController`都繼承了`ILightingController`介面，此介面包含了以下功能:

- Open(string host)
- Close()
- SendCommand(string command)
- SetIntensity(int channel, int intensity)
- SetIntensity(IChannelController channel, int intensity)
- SetStrobeMode(int channel, StrobeModes mode)
- SetStrobeMode(IChannelController channel, StrobeModes mode)
- SetOnOff(int channel, bool mode)
- SetOnOff(IChannelController channel, bool mode)
- CheckSum(string command)
  
## 建立Controller

建立LightController有三種方法:

1. 建立Rs232LightingController(RS232介面)
2. 建立EthernetLightingController(Ethernet介面)
3. 從LightingControllerProvider獲取

### 建立Rs232LightingController

以VLP-2430-2控制器為例，以下將示範初始化控制器物件並設定:
> ```cs
> ILightingController controller = new Rs232LightingController("VLP-2430-2",2);
> controller.Open("COM1");                    // 開啟通道
> controller.SetIntensity(0, 255);            // 將channel 0的光源亮度值設為255
> controller.SetStrobeMode(0, StrobeModes.F1) // 將channel 0的Strobe Mode設為F1
> controller.SetOnOff(0, true);               // 將channel 0設為啟用
> ```